#!/usr/bin/env bash
function __dotfiles_remove_path() {
    local -n __path_var=$1
    local path_to_remove=$2
    if [[ "$__path_var" = "$path_to_remove" ]]
    then
    __path_var=
    else
    __path_var=${__path_var//:$path_to_remove:/:} # delete instances in the middle
    __path_var=${__path_var#$path_to_remove:} # delete instance at the beginning
    __path_var=${__path_var%:$path_to_remove} # delete instance at the end
    fi
}

function dotfiles_remove_path() {
    __dotfiles_remove_path PATH "$1"
}

# https://stackoverflow.com/questions/73616907/how-to-use-node-in-wsl-zsh-exec-format-error-node/73616991#73616991
DOTFILES_REAL_NODE=$(
    dotfiles_remove_path "/home/$USER/bin"
    command which node
)
"$(ldd "$DOTFILES_REAL_NODE" | grep ld-linux-x86-64.so.2 | awk '{print $1}')" "$DOTFILES_REAL_NODE" "$@"
